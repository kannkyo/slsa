---
language: ja
---
# セキュリティレベル

<span class="subtitle">

各レベルは、ソフトウェアが改ざんされておらず、そのソースに安全にさかのぼることができると言う方法で、信頼度を高めます。

</span>

| レベル | 説明                                   | 例                                           |
| :----- | :------------------------------------- | :------------------------------------------- |
| 1      | ビルドプロセスのドキュメント           | 署名されていない来歴                         |
| 2      | ビルドサービスの耐タンパー性           | ホストされたソース/ビルド、署名された来歴    |
| 3      | 特定の脅威に対する余分な抵抗を防ぎます | ホストのセキュリティ管理、改ざん不可能な来歴 |
| 4      | 最高レベルの信頼と信用                 | Two-party レビュー + 堅牢ビルド              |

理想的なセキュリティ状態を実現するには数年かかる場合があります。中間のマイルストーンが重要です。SLSA は、ソフトウェアのセキュリティを徐々に改善するためのガイドです。重要なインフラストラクチャや重要なビジネスオペレーションで使用されるアーティファクトは、より高いレベルのセキュリティを実現したい場合がありますが、リスクの低いソフトウェアは、快適なときに停止できます。

## 詳細な説明

| レベル | 要件                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| ------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 0      | **保証はありません。** SLSA 0 は、SLSA レベルがないことを表します。                                                                                                                                                                                                                                                                                                                                                                                 |
| 1      | **ビルドプロセスは完全にスクリプト化/自動化され、来歴を生成する必要があります。** 来歴は、ビルドプロセス、トップレベルのソース、依存関係など、アーティファクトのビルド方法に関するメタデータです。来歴を知ることにより、ソフトウェアの消費者はリスクベースのセキュリティ決定を行うことができます。SLSA 1 の来歴は改ざんから保護しませんが、基本レベルのコードソース識別を提供し、脆弱性管理に役立ちます。                                           |
| 2      | **バージョン管理と認証された来歴を生成するホストビルドサービスを使用する必要があります。** これらの追加要件により、ソフトウェアの利用者はソフトウェアの出所についてより大きな信頼を得ることができます。このレベルでは、来歴により、ビルドサービスが信頼できる範囲での改ざんが防止されます。SLSA 2 は、SLSA3 への簡単なアップグレードパスも提供します。                                                                                              |
| 3      | **ソースプラットフォームとビルドプラットフォームは、それぞれソースの監査可能性と来歴の整合性を保証するための特定の基準を満たしています。** プラットフォームが要件を満たしていることを監査人が証明する認定プロセスを想定しており、消費者はそれを信頼できます。SLSA 3 は、クロスビルド汚染などの特定のクラスの脅威を防止することにより、以前のレベルよりもはるかに強力な改ざんに対する保護を提供します。                                              |
| 4      | **すべての変更の 2 人によるレビューと、気密で再現性のあるビルドプロセスが必要です。** 2 人によるレビューは、間違いを見つけて不正な動作を阻止するための業界のベストプラクティスです。密封ビルドは、来歴の依存関係のリストが完全であることを保証します。再現性のあるビルドは、厳密には必須ではありませんが、多くの監査可能性と信頼性の利点を提供します。全体として、SLSA 4 は、ソフトウェアが改ざんされていないという高い信頼性を消費者に提供します。 |

SLSA レベルは推移的ではありません([FAQ](faq.md)を参照)。
これにより、各アーティファクトの SLSA レーティングが互いに独立し、リスクに基づいて並行して進行し、優先順位を付けることができます。
このレベルでは、アーティファクトのビルドプロセスとトップレベルソースの整合性保護について説明しますが、アーティファクトの依存関係については説明しません。
依存関係には独自の SLSA レーティングがあり、SLSA0 の依存関係から SLSA4 アーティファクトを構築できます。

## レベル要件

次の表に、各レベルの[要件](requirements.md)の概要を示します。

| 要件                            | SLSA 1 | SLSA 2 | SLSA 3  | SLSA 4 |
| ------------------------------- | ------ | ------ | ------- | ------ |
| ソース - [バージョン管理]       |        | ✓      | ✓       | ✓      |
| ソース - [履歴の認証]           |        |        | ✓       | ✓      |
| ソース - [無期限保持]           |        |        | 18 か月 | ✓      |
| ソース - [2者レビュー]          |        |        |         | ✓      |
| ビルド - [ビルドのスクリプト化] | ✓      | ✓      | ✓       | ✓      |
| ビルド - [ビルドのサービス化]   |        | ✓      | ✓       | ✓      |
| ビルド - [ビルドのコード管理]   |        |        | ✓       | ✓      |
| ビルド - [エフェメラル環境]     |        |        | ✓       | ✓      |
| ビルド - [独立性]               |        |        | ✓       | ✓      |
| ビルド - [パラメータレス]       |        |        |         | ✓      |
| ビルド - [密封性]               |        |        |         | ✓      |
| ビルド - [再現可能性]           |        |        |         | ○      |
| 来歴 - [可用性]                 | ✓      | ✓      | ✓       | ✓      |
| 来歴 - [認証済]                 |        | ✓      | ✓       | ✓      |
| 来歴 - [生成のサービス化]       |        | ✓      | ✓       | ✓      |
| 来歴 - [反証不可能性]           |        |        | ✓       | ✓      |
| 来歴 - [依存関係が完了しました] |        |        |         | ✓      |
| 共通 - [セキュリティ]           |        |        |         | ✓      |
| 共通 - [アクセス]               |        |        |         | ✓      |
| 共通 - [スーパーユーザー]       |        |        |         | ✓      |

<!-- markdownlint-disable-next-line MD036 -->
_○=正当な理由がない限り必須_

[アクセス]: requirements.md#access
[認証済]: requirements.md#authenticated
[可用性]: requirements.md#available
[ビルドのコード管理]: requirements.md#build-as-code
[ビルドのサービス化]: requirements.md#build-service
[依存関係が完了しました]: requirements.md#dependencies-complete
[エフェメラル環境]: requirements.md#ephemeral-environment
[密封性]: requirements.md#hermetic
[独立性]: requirements.md#isolated
[反証不可能性]: requirements.md#non-falsifiable
[パラメータレス]: requirements.md#parameterless
[再現可能性]: requirements.md#reproducible
[無期限保持]: requirements.md#retained-indefinitely
[ビルドのスクリプト化]: requirements.md#scripted-build
[セキュリティ]: requirements.md#security
[生成のサービス化]: requirements.md#service-generated
[スーパーユーザー]: requirements.md#superusers
[2者レビュー]: requirements.md#two-person-reviewed
[履歴の認証]: requirements.md#verified-history
[バージョン管理]:requirements.md#version-controlled

## <a name="threats"></a>サプライチェーンの脅威

攻撃は、一般的なソフトウェアサプライチェーンのすべてのリンクで発生する可能性があり、これらの種類の攻撃は、今日の環境ではますます公開され、破壊的で、コストがかかります。SLSA の開発では、このような既知の例のリスクを具体的に軽減するために、各レベルの要件があります。

![サプライチェーンの脅威](../../images/supply-chain-threats.svg)

最近の注目を集める攻撃の多くは、サプライチェーンの整合性の脆弱性の結果であり、SLSA のフレームワークによって防止できた可能性があります。例えば:

|     | 脅威                                                                       | 既知の例                                                                                                                                                                         | SLSA がどのように役立つか                                                                                                                                                                                  |
| --- | -------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| A   | 不正なコードをソースリポジトリに送信する                                   | [Linux偽善者のコミット]:研究者は、メーリングリストのパッチを介して Linux カーネルに脆弱性を意図的に導入しようとしました。                                                        | 2 人によるレビューで、すべてではありませんが、ほとんどの脆弱性が検出されました。                                                                                                                           |
| B   | ソース管理プラットフォームの侵害                                           | [PHP]:攻撃者は PHP の自己ホスト型 git サーバーを侵害し、2 つの悪意のあるコミットを挿入しました。                                                                                 | より適切に保護されたソースコードプラットフォームは、攻撃者にとってはるかに困難な標的でした。                                                                                                               |
| C   | 公式プロセスでビルドしますが、ソース管理と一致しないコードから             | [Webmin]:攻撃者は、ソース管理と一致しないソースファイルを使用するようにビルドインフラストラクチャを変更しました。                                                                | SLSA 準拠のビルドサーバーは、使用されている実際のソースを特定する来歴を生成し、消費者がそのような改ざんを検出できるようにします。                                                                          |
| D   | 妥協ビルドプラットフォーム                                                 | [SolarWinds]:攻撃者はビルドプラットフォームを侵害し、ビルドごとに悪意のある動作を注入するインプラントをインストールしました。                                                    | SLSA レベルが高くなると、[ビルドプラットフォームのより強力なセキュリティ制御](requirements.md# build-requirements)が必要になり、妥協して永続性を得ることがより困難になります。                             |
| E   | 悪い依存関係を使用する(つまり、AH、再帰的に)                               | [イベントストリーム]:攻撃者は無害な依存関係を追加し、後で依存関係を更新して悪意のある動作を追加しました。更新は、GitHub に送信されたコード(つまり、攻撃 F)と一致しませんでした。 | SLSA をすべての依存関係に再帰的に適用すると、この特定のベクターが防止されます。これは、来歴が、SLSA が適切なビルダーからビルドされていないか、ソースが GitHub からのものではないことを示しているためです。 |
| F   | CI / CD システムによって構築されていないアーティファクトをアップロードする | [Codecov]:攻撃者は、漏洩したクレデンシャルを使用して、悪意のあるアーティファクトを GCS バケットにアップロードし、そこからユーザーが直接ダウンロードしました。                    | GCS バケット内のアーティファクトの来歴は、アーティファクトが予想されるソースリポジトリから予想される方法で構築されなかったことを示しています。                                                             |
| G   | パッケージリポジトリの侵害                                                 | [パッケージミラーへの攻撃]:研究者は、悪意のあるパッケージを提供するために使用された可能性のある、いくつかの人気のあるパッケージリポジトリに対してミラーを実行しました。          | 上記(F)と同様に、悪意のあるアーティファクトの出所は、それらが期待どおりに、または期待されたソースリポジトリから構築されていないことを示していました。                                                      |
| H   | 消費者をだまして悪いパッケージを使用させる                                 | [タイポスクワッティングの閲覧]:攻撃者は、元のパッケージと同じ名前の悪意のあるパッケージをアップロードしました。                                                                  | SLSA はこの脅威に直接対処しませんが、ソース管理にリンクしている来歴は、他のソリューションを有効にして強化できます。                                                                                        |

[Linux偽善者のコミット]: https://lore.kernel.org/lkml/202105051005.49BFABCE@keescook/
[php]: https://news-web.php.net/php.internals/113838
[webmin]: https://www.webmin.com/exploit.html
[solarwinds]: https://www.crowdstrike.com/blog/sunspot-malware-technical-analysis/
[イベントストリーム]: https://schneider.dev/blog/event-stream-vulnerability-explained/
[codecov]: https://about.codecov.io/apr-2021-post-mortem/
[パッケージミラーへの攻撃]: https://theupdateframework.io/papers/attacks-on-package-managers-ccs2008.pdf
[タイポスクワッティングの閲覧]: https://blog.sonatype.com/damaging-linux-mac-malware-bundled-within-browserify-npm-brandjack-attempt

SLSA レベルは、ソフトウェアが改ざんされていないことを消費者に確信させるのに役立ちます。
ソースまで安全にたどることができます。
そうでない場合でも難しいことです。
今日のほとんどのソフトウェアでは不可能です。

## 制限

SLSA は、ソフトウェア成果物におけるサプライチェーンの脅威を軽減するのに役立ちますが、制限があります。

-   マントアーティファクトのサプライチェーンには、かなりの数の依存関係があります。依存関係の完全なグラフは、手に負えないほど大きくなる可能性があります。
-   実際には、セキュリティに取り組んでいるチームは、サプライチェーンの重要なコンポーネントを特定して集中する必要があります。これは手動で実行できますが、かなりの労力がかかる可能性があります。
-   アーティファクトの SLSA レベルは推移的ではなく([FAQ](faq.md)を参照)、依存関係には独自の SLSA 評価があります。これは、SLSA4 アーティファクトが SLSA0 の依存関係から構築される可能性があることを意味します。したがって、メインのアーティファクトには強力なセキュリティがありますが、リスクは他の場所に存在する可能性があります。これらのリスクの総計は、ソフトウェアの消費者が SLSA4 アーティファクトを使用する方法と場所を理解するのに役立ちます。
-   これらのタスクの自動化は役立ちますが、すべてのソフトウェアコンシューマーが、すべてのアーティファクトのグラフ全体を完全に精査することは現実的ではありません。このギャップを埋めるために、監査人と認定機関は、何かが SLSA 要件を満たしていることを確認および主張できます。これは、クローズドソースソフトウェアにとって特に価値があります。

[ロードマップ](roadmap.md)の一部として、重要なコンポーネントを特定する方法、サプライチェーン全体の総リスクを決定する方法、および認定の役割について説明します。
